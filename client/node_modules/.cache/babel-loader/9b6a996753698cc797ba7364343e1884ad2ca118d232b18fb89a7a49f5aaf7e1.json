{"ast":null,"code":"import React,{createContext,useContext,useState,useEffect}from'react';import api from'../config/axios';import{toast}from'react-toastify';import{useAuth}from'./AuthContext';import{jsx as _jsx}from\"react/jsx-runtime\";const CartContext=/*#__PURE__*/createContext();export const useCart=()=>{const context=useContext(CartContext);if(!context){throw new Error('useCart must be used within a CartProvider');}return context;};export const CartProvider=_ref=>{let{children}=_ref;const[cart,setCart]=useState({articles:[]});const[loading,setLoading]=useState(false);const{isAuthenticated}=useAuth();// Charger le panier depuis l'API\nconst loadCart=async()=>{if(!isAuthenticated)return;try{setLoading(true);const res=await api.get('/api/cart');setCart(res.data);}catch(err){console.error('Erreur lors du chargement du panier:',err);}finally{setLoading(false);}};// Charger le panier quand l'utilisateur se connecte\nuseEffect(()=>{if(isAuthenticated){loadCart();}else{setCart({articles:[]});}},[isAuthenticated]);// Ajouter un article au panier\nconst addToCart=async(productId,quantity,size,color)=>{if(!isAuthenticated){toast.error('Veuillez vous connecter pour ajouter des articles au panier');return{success:false};}try{setLoading(true);const res=await api.post('/api/cart/ajouter',{produitId:productId,quantite:quantity,taille:size,couleur:color});setCart(res.data);toast.success('Article ajouté au panier !');return{success:true};}catch(err){var _err$response,_err$response$data;const message=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Erreur lors de l\\'ajout au panier';toast.error(message);return{success:false,message};}finally{setLoading(false);}};// Modifier la quantité d'un article\nconst updateQuantity=async(articleId,quantity)=>{try{setLoading(true);const res=await api.put(\"/api/cart/modifier/\".concat(articleId),{quantite:quantity});setCart(res.data);toast.success('Quantité mise à jour !');return{success:true};}catch(err){var _err$response2,_err$response2$data;const message=((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Erreur lors de la mise à jour';toast.error(message);return{success:false,message};}finally{setLoading(false);}};// Supprimer un article du panier\nconst removeFromCart=async articleId=>{try{setLoading(true);const res=await api.delete(\"/api/cart/supprimer/\".concat(articleId));setCart(res.data);toast.success('Article supprimé du panier !');return{success:true};}catch(err){var _err$response3,_err$response3$data;const message=((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.message)||'Erreur lors de la suppression';toast.error(message);return{success:false,message};}finally{setLoading(false);}};// Vider le panier\nconst clearCart=async()=>{try{setLoading(true);await api.delete('/api/cart/vider');setCart({articles:[]});toast.success('Panier vidé !');return{success:true};}catch(err){var _err$response4,_err$response4$data;const message=((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.message)||'Erreur lors du vidage du panier';toast.error(message);return{success:false,message};}finally{setLoading(false);}};// Calculer le total du panier\nconst getTotal=()=>{return cart.articles.reduce((total,article)=>{return total+article.prixUnitaire*article.quantite;},0);};// Obtenir le nombre total d'articles\nconst getItemCount=()=>{return cart.articles.reduce((count,article)=>count+article.quantite,0);};// Vérifier si le panier est vide\nconst isEmpty=()=>{return cart.articles.length===0;};const value={cart,loading,addToCart,updateQuantity,removeFromCart,clearCart,getTotal,getItemCount,isEmpty,loadCart};return/*#__PURE__*/_jsx(CartContext.Provider,{value:value,children:children});};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","api","toast","useAuth","jsx","_jsx","CartContext","useCart","context","Error","CartProvider","_ref","children","cart","setCart","articles","loading","setLoading","isAuthenticated","loadCart","res","get","data","err","console","error","addToCart","productId","quantity","size","color","success","post","produitId","quantite","taille","couleur","_err$response","_err$response$data","message","response","updateQuantity","articleId","put","concat","_err$response2","_err$response2$data","removeFromCart","delete","_err$response3","_err$response3$data","clearCart","_err$response4","_err$response4$data","getTotal","reduce","total","article","prixUnitaire","getItemCount","count","isEmpty","length","value","Provider"],"sources":["C:/Users/houda/OneDrive/Bureau/boutique-vetements/client/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\r\nimport api from '../config/axios';\r\nimport { toast } from 'react-toastify';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const useCart = () => {\r\n  const context = useContext(CartContext);\r\n  if (!context) {\r\n    throw new Error('useCart must be used within a CartProvider');\r\n  }\r\n  return context;\r\n};\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cart, setCart] = useState({ articles: [] });\r\n  const [loading, setLoading] = useState(false);\r\n  const { isAuthenticated } = useAuth();\r\n\r\n  // Charger le panier depuis l'API\r\n  const loadCart = async () => {\r\n    if (!isAuthenticated) return;\r\n    \r\n    try {\r\n      setLoading(true);\r\n      const res = await api.get('/api/cart');\r\n      setCart(res.data);\r\n    } catch (err) {\r\n      console.error('Erreur lors du chargement du panier:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Charger le panier quand l'utilisateur se connecte\r\n  useEffect(() => {\r\n    if (isAuthenticated) {\r\n      loadCart();\r\n    } else {\r\n      setCart({ articles: [] });\r\n    }\r\n  }, [isAuthenticated]);\r\n\r\n  // Ajouter un article au panier\r\n  const addToCart = async (productId, quantity, size, color) => {\r\n    if (!isAuthenticated) {\r\n      toast.error('Veuillez vous connecter pour ajouter des articles au panier');\r\n      return { success: false };\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      const res = await api.post('/api/cart/ajouter', {\r\n        produitId: productId,\r\n        quantite: quantity,\r\n        taille: size,\r\n        couleur: color\r\n      });\r\n      \r\n      setCart(res.data);\r\n      toast.success('Article ajouté au panier !');\r\n      return { success: true };\r\n    } catch (err) {\r\n      const message = err.response?.data?.message || 'Erreur lors de l\\'ajout au panier';\r\n      toast.error(message);\r\n      return { success: false, message };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Modifier la quantité d'un article\r\n  const updateQuantity = async (articleId, quantity) => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await api.put(`/api/cart/modifier/${articleId}`, {\r\n        quantite: quantity\r\n      });\r\n      \r\n      setCart(res.data);\r\n      toast.success('Quantité mise à jour !');\r\n      return { success: true };\r\n    } catch (err) {\r\n      const message = err.response?.data?.message || 'Erreur lors de la mise à jour';\r\n      toast.error(message);\r\n      return { success: false, message };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Supprimer un article du panier\r\n  const removeFromCart = async (articleId) => {\r\n    try {\r\n      setLoading(true);\r\n      const res = await api.delete(`/api/cart/supprimer/${articleId}`);\r\n      \r\n      setCart(res.data);\r\n      toast.success('Article supprimé du panier !');\r\n      return { success: true };\r\n    } catch (err) {\r\n      const message = err.response?.data?.message || 'Erreur lors de la suppression';\r\n      toast.error(message);\r\n      return { success: false, message };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Vider le panier\r\n  const clearCart = async () => {\r\n    try {\r\n      setLoading(true);\r\n      await api.delete('/api/cart/vider');\r\n      \r\n      setCart({ articles: [] });\r\n      toast.success('Panier vidé !');\r\n      return { success: true };\r\n    } catch (err) {\r\n      const message = err.response?.data?.message || 'Erreur lors du vidage du panier';\r\n      toast.error(message);\r\n      return { success: false, message };\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculer le total du panier\r\n  const getTotal = () => {\r\n    return cart.articles.reduce((total, article) => {\r\n      return total + (article.prixUnitaire * article.quantite);\r\n    }, 0);\r\n  };\r\n\r\n  // Obtenir le nombre total d'articles\r\n  const getItemCount = () => {\r\n    return cart.articles.reduce((count, article) => count + article.quantite, 0);\r\n  };\r\n\r\n  // Vérifier si le panier est vide\r\n  const isEmpty = () => {\r\n    return cart.articles.length === 0;\r\n  };\r\n\r\n  const value = {\r\n    cart,\r\n    loading,\r\n    addToCart,\r\n    updateQuantity,\r\n    removeFromCart,\r\n    clearCart,\r\n    getTotal,\r\n    getItemCount,\r\n    isEmpty,\r\n    loadCart\r\n  };\r\n\r\n  return (\r\n    <CartContext.Provider value={value}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,UAAU,CAAEC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC7E,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CACjC,OAASC,KAAK,KAAQ,gBAAgB,CACtC,OAASC,OAAO,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAExC,KAAM,CAAAC,WAAW,cAAGT,aAAa,CAAC,CAAC,CAEnC,MAAO,MAAM,CAAAU,OAAO,CAAGA,CAAA,GAAM,CAC3B,KAAM,CAAAC,OAAO,CAAGV,UAAU,CAACQ,WAAW,CAAC,CACvC,GAAI,CAACE,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAC,KAAK,CAAC,4CAA4C,CAAC,CAC/D,CACA,MAAO,CAAAD,OAAO,CAChB,CAAC,CAED,MAAO,MAAM,CAAAE,YAAY,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CACvC,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGf,QAAQ,CAAC,CAAEgB,QAAQ,CAAE,EAAG,CAAC,CAAC,CAClD,KAAM,CAACC,OAAO,CAAEC,UAAU,CAAC,CAAGlB,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAAEmB,eAAgB,CAAC,CAAGf,OAAO,CAAC,CAAC,CAErC;AACA,KAAM,CAAAgB,QAAQ,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAI,CAACD,eAAe,CAAE,OAEtB,GAAI,CACFD,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAG,GAAG,CAAG,KAAM,CAAAnB,GAAG,CAACoB,GAAG,CAAC,WAAW,CAAC,CACtCP,OAAO,CAACM,GAAG,CAACE,IAAI,CAAC,CACnB,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAAC,sCAAsC,CAAEF,GAAG,CAAC,CAC5D,CAAC,OAAS,CACRN,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACAjB,SAAS,CAAC,IAAM,CACd,GAAIkB,eAAe,CAAE,CACnBC,QAAQ,CAAC,CAAC,CACZ,CAAC,IAAM,CACLL,OAAO,CAAC,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAAC,CAC3B,CACF,CAAC,CAAE,CAACG,eAAe,CAAC,CAAC,CAErB;AACA,KAAM,CAAAQ,SAAS,CAAG,KAAAA,CAAOC,SAAS,CAAEC,QAAQ,CAAEC,IAAI,CAAEC,KAAK,GAAK,CAC5D,GAAI,CAACZ,eAAe,CAAE,CACpBhB,KAAK,CAACuB,KAAK,CAAC,6DAA6D,CAAC,CAC1E,MAAO,CAAEM,OAAO,CAAE,KAAM,CAAC,CAC3B,CAEA,GAAI,CACFd,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAG,GAAG,CAAG,KAAM,CAAAnB,GAAG,CAAC+B,IAAI,CAAC,mBAAmB,CAAE,CAC9CC,SAAS,CAAEN,SAAS,CACpBO,QAAQ,CAAEN,QAAQ,CAClBO,MAAM,CAAEN,IAAI,CACZO,OAAO,CAAEN,KACX,CAAC,CAAC,CAEFhB,OAAO,CAACM,GAAG,CAACE,IAAI,CAAC,CACjBpB,KAAK,CAAC6B,OAAO,CAAC,4BAA4B,CAAC,CAC3C,MAAO,CAAEA,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,GAAG,CAAE,KAAAc,aAAA,CAAAC,kBAAA,CACZ,KAAM,CAAAC,OAAO,CAAG,EAAAF,aAAA,CAAAd,GAAG,CAACiB,QAAQ,UAAAH,aAAA,kBAAAC,kBAAA,CAAZD,aAAA,CAAcf,IAAI,UAAAgB,kBAAA,iBAAlBA,kBAAA,CAAoBC,OAAO,GAAI,mCAAmC,CAClFrC,KAAK,CAACuB,KAAK,CAACc,OAAO,CAAC,CACpB,MAAO,CAAER,OAAO,CAAE,KAAK,CAAEQ,OAAQ,CAAC,CACpC,CAAC,OAAS,CACRtB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAwB,cAAc,CAAG,KAAAA,CAAOC,SAAS,CAAEd,QAAQ,GAAK,CACpD,GAAI,CACFX,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAG,GAAG,CAAG,KAAM,CAAAnB,GAAG,CAAC0C,GAAG,uBAAAC,MAAA,CAAuBF,SAAS,EAAI,CAC3DR,QAAQ,CAAEN,QACZ,CAAC,CAAC,CAEFd,OAAO,CAACM,GAAG,CAACE,IAAI,CAAC,CACjBpB,KAAK,CAAC6B,OAAO,CAAC,wBAAwB,CAAC,CACvC,MAAO,CAAEA,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,GAAG,CAAE,KAAAsB,cAAA,CAAAC,mBAAA,CACZ,KAAM,CAAAP,OAAO,CAAG,EAAAM,cAAA,CAAAtB,GAAG,CAACiB,QAAQ,UAAAK,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAcvB,IAAI,UAAAwB,mBAAA,iBAAlBA,mBAAA,CAAoBP,OAAO,GAAI,+BAA+B,CAC9ErC,KAAK,CAACuB,KAAK,CAACc,OAAO,CAAC,CACpB,MAAO,CAAER,OAAO,CAAE,KAAK,CAAEQ,OAAQ,CAAC,CACpC,CAAC,OAAS,CACRtB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAA8B,cAAc,CAAG,KAAO,CAAAL,SAAS,EAAK,CAC1C,GAAI,CACFzB,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAG,GAAG,CAAG,KAAM,CAAAnB,GAAG,CAAC+C,MAAM,wBAAAJ,MAAA,CAAwBF,SAAS,CAAE,CAAC,CAEhE5B,OAAO,CAACM,GAAG,CAACE,IAAI,CAAC,CACjBpB,KAAK,CAAC6B,OAAO,CAAC,8BAA8B,CAAC,CAC7C,MAAO,CAAEA,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,GAAG,CAAE,KAAA0B,cAAA,CAAAC,mBAAA,CACZ,KAAM,CAAAX,OAAO,CAAG,EAAAU,cAAA,CAAA1B,GAAG,CAACiB,QAAQ,UAAAS,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc3B,IAAI,UAAA4B,mBAAA,iBAAlBA,mBAAA,CAAoBX,OAAO,GAAI,+BAA+B,CAC9ErC,KAAK,CAACuB,KAAK,CAACc,OAAO,CAAC,CACpB,MAAO,CAAER,OAAO,CAAE,KAAK,CAAEQ,OAAQ,CAAC,CACpC,CAAC,OAAS,CACRtB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAkC,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B,GAAI,CACFlC,UAAU,CAAC,IAAI,CAAC,CAChB,KAAM,CAAAhB,GAAG,CAAC+C,MAAM,CAAC,iBAAiB,CAAC,CAEnClC,OAAO,CAAC,CAAEC,QAAQ,CAAE,EAAG,CAAC,CAAC,CACzBb,KAAK,CAAC6B,OAAO,CAAC,eAAe,CAAC,CAC9B,MAAO,CAAEA,OAAO,CAAE,IAAK,CAAC,CAC1B,CAAE,MAAOR,GAAG,CAAE,KAAA6B,cAAA,CAAAC,mBAAA,CACZ,KAAM,CAAAd,OAAO,CAAG,EAAAa,cAAA,CAAA7B,GAAG,CAACiB,QAAQ,UAAAY,cAAA,kBAAAC,mBAAA,CAAZD,cAAA,CAAc9B,IAAI,UAAA+B,mBAAA,iBAAlBA,mBAAA,CAAoBd,OAAO,GAAI,iCAAiC,CAChFrC,KAAK,CAACuB,KAAK,CAACc,OAAO,CAAC,CACpB,MAAO,CAAER,OAAO,CAAE,KAAK,CAAEQ,OAAQ,CAAC,CACpC,CAAC,OAAS,CACRtB,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED;AACA,KAAM,CAAAqC,QAAQ,CAAGA,CAAA,GAAM,CACrB,MAAO,CAAAzC,IAAI,CAACE,QAAQ,CAACwC,MAAM,CAAC,CAACC,KAAK,CAAEC,OAAO,GAAK,CAC9C,MAAO,CAAAD,KAAK,CAAIC,OAAO,CAACC,YAAY,CAAGD,OAAO,CAACvB,QAAS,CAC1D,CAAC,CAAE,CAAC,CAAC,CACP,CAAC,CAED;AACA,KAAM,CAAAyB,YAAY,CAAGA,CAAA,GAAM,CACzB,MAAO,CAAA9C,IAAI,CAACE,QAAQ,CAACwC,MAAM,CAAC,CAACK,KAAK,CAAEH,OAAO,GAAKG,KAAK,CAAGH,OAAO,CAACvB,QAAQ,CAAE,CAAC,CAAC,CAC9E,CAAC,CAED;AACA,KAAM,CAAA2B,OAAO,CAAGA,CAAA,GAAM,CACpB,MAAO,CAAAhD,IAAI,CAACE,QAAQ,CAAC+C,MAAM,GAAK,CAAC,CACnC,CAAC,CAED,KAAM,CAAAC,KAAK,CAAG,CACZlD,IAAI,CACJG,OAAO,CACPU,SAAS,CACTe,cAAc,CACdM,cAAc,CACdI,SAAS,CACTG,QAAQ,CACRK,YAAY,CACZE,OAAO,CACP1C,QACF,CAAC,CAED,mBACEd,IAAA,CAACC,WAAW,CAAC0D,QAAQ,EAACD,KAAK,CAAEA,KAAM,CAAAnD,QAAA,CAChCA,QAAQ,CACW,CAAC,CAE3B,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}